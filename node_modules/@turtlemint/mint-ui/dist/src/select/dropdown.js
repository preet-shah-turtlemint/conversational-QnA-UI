"use strict";
var __makeTemplateObject = (this && this.__makeTemplateObject) || function (cooked, raw) {
    if (Object.defineProperty) { Object.defineProperty(cooked, "raw", { value: raw }); } else { cooked.raw = raw; }
    return cooked;
};
var __assign = (this && this.__assign) || function () {
    __assign = Object.assign || function(t) {
        for (var s, i = 1, n = arguments.length; i < n; i++) {
            s = arguments[i];
            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))
                t[p] = s[p];
        }
        return t;
    };
    return __assign.apply(this, arguments);
};
var __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    Object.defineProperty(o, k2, { enumerable: true, get: function() { return m[k]; } });
}) : (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    o[k2] = m[k];
}));
var __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {
    Object.defineProperty(o, "default", { enumerable: true, value: v });
}) : function(o, v) {
    o["default"] = v;
});
var __importStar = (this && this.__importStar) || function (mod) {
    if (mod && mod.__esModule) return mod;
    var result = {};
    if (mod != null) for (var k in mod) if (Object.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);
    __setModuleDefault(result, mod);
    return result;
};
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
exports.StyledOption = exports.List = exports.DropdownWrapper = exports.Option = exports.Dropdown = void 0;
var React = __importStar(require("react"));
var styled_components_1 = __importStar(require("styled-components"));
var colors_1 = __importDefault(require("../__utils/colors"));
var app_1 = require("../app");
exports.Dropdown = function (_a) {
    var _b;
    var onSelect = _a.onSelect, _c = _a.options, options = _c === void 0 ? [] : _c, style = _a.style, loading = _a.loading, _d = _a.displayKey, displayKey = _d === void 0 ? "text" : _d, _e = _a.valueKey, valueKey = _e === void 0 ? "value" : _e, _f = _a.codeKey, codeKey = _f === void 0 ? "code" : _f, groups = _a.groups, _g = _a.openInModal, openInModal = _g === void 0 ? false : _g, _h = _a.OptionJSX, OptionJSX = _h === void 0 ? exports.Option : _h, _j = _a.selectedValue, selectedValue = _j === void 0 ? {} : _j, listStyle = _a.listStyle, _k = _a.theme, theme = _k === void 0 ? colors_1.default : _k;
    var localOptions = options;
    var finalTheme = __assign(__assign({}, colors_1.default), theme);
    var handleSelect = function (event) {
        var _a;
        event.preventDefault();
        var text = event.target.innerText || event.target.textContent || "";
        var value = event.target.getAttribute("value") || "";
        onSelect ? onSelect((_a = {}, _a[valueKey] = value, _a[displayKey] = text, _a)) : null;
    };
    if (groups && groups instanceof Array && groups.length) {
        var tempLocalOptions_1 = [];
        var groupCodes_1 = [];
        groups.forEach(function (group) {
            groupCodes_1.push(group[codeKey]);
            var groupOptions = options.filter(function (option) { return option[codeKey] === group[codeKey]; });
            tempLocalOptions_1 = tempLocalOptions_1
                .concat([__assign({ type: "label" }, group)])
                .concat(groupOptions);
        });
        var optionOutOfGroups = options.filter(function (option) { return groupCodes_1.indexOf(option[codeKey]) === -1; });
        // Manually entry for remaning entries which does not belong to any group
        if (optionOutOfGroups.length) {
            localOptions = tempLocalOptions_1
                .concat([
                (_b = { type: "label" }, _b[displayKey] = "Rest", _b[codeKey] = "rest", _b)
            ])
                .concat(optionOutOfGroups);
        }
    }
    return (React.createElement(exports.DropdownWrapper, { style: style, openInModal: openInModal, theme: finalTheme },
        React.createElement(exports.List, { style: listStyle, openInModal: openInModal, theme: finalTheme },
            loading ? (React.createElement(OptionJSX, { handleSelect: function () { } }, "Loading...")) : null,
            localOptions.map(function (item) {
                // In case we need to add labels between options
                if (item.type && item.type === "label") {
                    return (React.createElement(OptionJSX, { key: item[codeKey].toString(), type: "label" },
                        React.createElement(GroupLabel, null,
                            item[displayKey],
                            " ")));
                }
                return (React.createElement(OptionJSX, { key: item[valueKey].toString(), value: item[valueKey], handleSelect: handleSelect, selectedValue: selectedValue }, item[displayKey]));
            }))));
};
exports.Option = function (_a) {
    var value = _a.value, _b = _a.disabled, disabled = _b === void 0 ? false : _b, children = _a.children, handleSelect = _a.handleSelect, _c = _a.type, type = _c === void 0 ? "default" : _c, _d = _a.theme, theme = _d === void 0 ? colors_1.default : _d;
    var finalTheme = __assign(__assign({}, colors_1.default), theme);
    return (React.createElement(exports.StyledOption, { value: value, disabled: disabled, onMouseDown: handleSelect, type: type, theme: finalTheme }, children));
};
exports.DropdownWrapper = styled_components_1.default.div(templateObject_3 || (templateObject_3 = __makeTemplateObject(["\n\t", ";\n\tmargin: 0;\n\tpadding: 0;\n\tlist-style: none;\n\tbackground-color: ", ";\n\tborder-radius: 4px;\n\toutline: none;\n\t-webkit-box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15);\n\tbox-shadow: 0 2px 8px rgba(0, 0, 0, 0.15);\n\t", "\n\twidth: 100%;\n\tz-index: 9999;\n"], ["\n\t", ";\n\tmargin: 0;\n\tpadding: 0;\n\tlist-style: none;\n\tbackground-color: ", ";\n\tborder-radius: 4px;\n\toutline: none;\n\t-webkit-box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15);\n\tbox-shadow: 0 2px 8px rgba(0, 0, 0, 0.15);\n\t",
    "\n\twidth: 100%;\n\tz-index: 9999;\n"])), app_1.GlobalStyles, function (_a) {
    var theme = _a.theme;
    return theme.WHITE;
}, function (props) {
    return props.openInModal
        ? styled_components_1.css(templateObject_1 || (templateObject_1 = __makeTemplateObject(["\n\t\t\t\t\tposition: relative;\n\t\t\t  "], ["\n\t\t\t\t\tposition: relative;\n\t\t\t  "]))) : styled_components_1.css(templateObject_2 || (templateObject_2 = __makeTemplateObject(["\n\t\t\t\t\tposition: absolute;\n\t\t\t  "], ["\n\t\t\t\t\tposition: absolute;\n\t\t\t  "])));
});
exports.List = styled_components_1.default.ul(templateObject_4 || (templateObject_4 = __makeTemplateObject(["\n\tborder: 1px solid ", ";\n\tborder-radius: 4px;\n\tlist-style: none;\n\tmargin: 0;\n\tpadding: 0;\n\tmax-height: ", ";\n\tmargin-bottom: 0;\n\tpadding-left: 0;\n\toverflow: auto;\n\toutline: none;\n"], ["\n\tborder: 1px solid ", ";\n\tborder-radius: 4px;\n\tlist-style: none;\n\tmargin: 0;\n\tpadding: 0;\n\tmax-height: ", ";\n\tmargin-bottom: 0;\n\tpadding-left: 0;\n\toverflow: auto;\n\toutline: none;\n"])), function (_a) {
    var theme = _a.theme;
    return theme.BACKGROUND_GREY;
}, function (_a) {
    var openInModal = _a.openInModal;
    return (openInModal ? "340px" : "160px");
});
exports.StyledOption = styled_components_1.default.li(templateObject_7 || (templateObject_7 = __makeTemplateObject(["\n\tdisplay: block;\n\tpadding: 5px 12px;\n\toverflow: hidden;\n\tcolor: ", ";\n\tfont-weight: normal;\n\tline-height: 22px;\n\twhite-space: nowrap;\n\ttext-overflow: ellipsis;\n\tcursor: pointer;\n\t-webkit-transition: background 0.3s ease;\n\ttransition: background 0.3s ease;\n\tposition: relative;\n\t", "\n\t&:first-of-type {\n\t\tcolor: rgba(0, 0, 0, 0.65);\n\t\tfont-weight: 500;\n\t\tbackground-color: #fafafa;\n\t}\n\t&:hover {\n\t\tbackground-color: #e6f7ff;\n\t}\n\t", "\n"], ["\n\tdisplay: block;\n\tpadding: 5px 12px;\n\toverflow: hidden;\n\tcolor: ", ";\n\tfont-weight: normal;\n\tline-height: 22px;\n\twhite-space: nowrap;\n\ttext-overflow: ellipsis;\n\tcursor: pointer;\n\t-webkit-transition: background 0.3s ease;\n\ttransition: background 0.3s ease;\n\tposition: relative;\n\t",
    "\n\t&:first-of-type {\n\t\tcolor: rgba(0, 0, 0, 0.65);\n\t\tfont-weight: 500;\n\t\tbackground-color: #fafafa;\n\t}\n\t&:hover {\n\t\tbackground-color: #e6f7ff;\n\t}\n\t",
    "\n"])), function (_a) {
    var theme = _a.theme;
    return theme.GREY1;
}, function (props) {
    return props.disabled && styled_components_1.css(templateObject_5 || (templateObject_5 = __makeTemplateObject(["\n\t\t\tcursor: no-drop;\n\t\t"], ["\n\t\t\tcursor: no-drop;\n\t\t"])));
}, function (props) {
    return props.type === "label" && styled_components_1.css(templateObject_6 || (templateObject_6 = __makeTemplateObject(["\n\t\t\t&:before {\n\t\t\t\tcontent: \"\";\n\t\t\t\tdisplay: block;\n\t\t\t\tbackground-color: #dadada;\n\t\t\t\theight: 1px;\n\t\t\t\twidth: 100%;\n\t\t\t\tposition: absolute;\n\t\t\t\ttop: 17px;\n\t\t\t\tleft: 0;\n\t\t\t\tz-index: 0;\n\t\t\t}\n\n\t\t\tcolor: rgba(0, 0, 0, 0.65);\n\t\t\tfont-weight: 500;\n\t\t\tbackground-color: #fafafa;\n\t\t\tpadding: 5px 6px;\n\t\t"], ["\n\t\t\t&:before {\n\t\t\t\tcontent: \"\";\n\t\t\t\tdisplay: block;\n\t\t\t\tbackground-color: #dadada;\n\t\t\t\theight: 1px;\n\t\t\t\twidth: 100%;\n\t\t\t\tposition: absolute;\n\t\t\t\ttop: 17px;\n\t\t\t\tleft: 0;\n\t\t\t\tz-index: 0;\n\t\t\t}\n\n\t\t\tcolor: rgba(0, 0, 0, 0.65);\n\t\t\tfont-weight: 500;\n\t\t\tbackground-color: #fafafa;\n\t\t\tpadding: 5px 6px;\n\t\t"])));
});
var GroupLabel = styled_components_1.default.span(templateObject_8 || (templateObject_8 = __makeTemplateObject(["\n\tposition: relative;\n\tz-index: 1;\n\tpadding: 0px 6px;\n\tbackground: #fafafa;\n"], ["\n\tposition: relative;\n\tz-index: 1;\n\tpadding: 0px 6px;\n\tbackground: #fafafa;\n"])));
exports.default = styled_components_1.withTheme(exports.Dropdown);
var templateObject_1, templateObject_2, templateObject_3, templateObject_4, templateObject_5, templateObject_6, templateObject_7, templateObject_8;
//# sourceMappingURL=dropdown.js.map